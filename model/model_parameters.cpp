
#include "MicroFlow.h"

void setup() {
  Serial.begin(9600);

  int topology[] = {7, 32, 32, 5};
  double weights[] = {-0.73768324, 0.09573083, 0.2712007, 0.32966965, -0.5880501, 0.4072917, -0.30477858, 0.103146374, -0.033563755, 0.38234976, 0.19995707, 0.10876203, 0.04040901, 0.4286259, 0.5278589, -0.117858544, -0.45593145, 0.10201911, 0.0814592, 0.45635572, 0.2271466, 0.31974328, 0.09830571, 0.43504286, -0.5627998, -0.5236803, 0.19170175, -0.03368861, -0.53255755, 0.30029792, 0.13434437, -0.7501698, -0.32730523, -0.6844852, -0.064108476, 0.16451114, -0.15139787, -0.3456637, -0.1177786, 0.34521088, -0.5743809, 0.4343908, 0.7320303, 0.17848597, 0.657374, 0.1575721, -0.59036267, -0.16514032, 0.4016562, -0.09358888, 0.32472718, -0.13953236, 0.27656066, 0.36376256, 0.49467456, -0.49514478, 0.47929615, -0.008766729, -0.15440354, 0.75867265, -0.5238684, -0.5914323, 0.16696258, -0.2795618, -0.3664813, 0.36383185, -0.24945335, -0.48227623, -0.12631157, -0.35787243, -0.016245969, 0.46007028, -0.28085715, -0.19216251, 0.29902497, 0.14693096, -0.34900302, -0.08129335, 0.0050758487, -0.0057891794, -0.15041763, -0.3344422, 0.11823068, 0.23558134, 0.4109871, 0.567898, 0.13424368, 0.3455598, -0.0416886, 0.008942197, 0.26412743, -0.41571182, 0.012437402, -0.21860951, -0.13765988, 0.122523874, 0.3067964, -0.61696213, 0.0523564, 0.006539028, 0.44418478, 0.30867615, 0.34367704, -0.09140423, -0.4631497, -0.015472096, -0.09847106, 0.21068783, -0.2861754, 0.2731371, 0.31733027, -0.06010648, -0.45738858, 0.195868, -0.15624091, -0.21429908, -0.29891586, -0.1636882, -0.2963553, -0.03472776, -0.3089031, 0.4508751, 0.64139193, 0.1710807, -0.23214039, 0.12339677, -0.09461638, -0.06795211, -0.15960076, -0.29963338, -0.2603709, 0.14198726, -0.24574846, -0.19062063, 0.09806934, -0.13130207, 0.4395681, -0.25815278, 0.44578972, -0.6074827, 0.2512118, -0.3225269, -0.094725564, -0.5514448, -0.055364106, 0.27945763, 0.1978269, 0.11629599, -0.28377205, 0.13235424, 0.1423389, 0.03956343, -0.053497456, -0.25839287, 0.29533178, -0.18566851, 0.07773798, 0.44524807, 0.0032152287, 0.34120008, -0.17560807, -0.2510842, 0.8611182, 0.23962535, -0.21710418, -0.046978027, -0.8866464, -0.3421344, 0.49221206, -0.40175635, 0.22684379, 0.079877764, 0.3411279, 0.06912559, 0.3556784, 0.7302585, 0.4323986, -0.67415696, -0.101167135, -0.4405363, 0.25697494, -0.43165705, -0.4582622, 0.3792823, -0.30217478, -0.39706922, 0.34132734, 0.13613737, 0.03755104, 0.039739024, 0.61559135, 0.13253418, 0.30853137, 0.07913223, 0.13485858, -0.27011362, -0.12194368, 0.32597086, 0.06426963, 0.21128717, 0.20505914, 0.37950966, 0.28117415, 0.29387465, 0.31812307, 0.24257424, -0.07853457, 0.31677803, -0.01976946, 0.33421227, 0.07829833, -0.25879854, 0.216957, 0.2718039, 0.22905132, -0.28296292, 0.14870808, 0.054825395, 0.32436565, 0.31840786, 0.37635812, 0.14076361, 0.28538284, 0.17509207, -0.12146748, 0.38295266, -0.1478926, 0.17788722, -0.6737958, -0.17620836, -0.038238022, 0.17877443, -0.11450958, 0.34943184, 0.35462254, -0.20244984, -0.4150976, 0.55072796, 0.05583486, -0.13846546, -0.34297034, -0.29294774, 0.106338635, -0.14630844, -0.113672346, -0.11541985, -0.04171665, -0.06880588, -0.23980393, -0.3332382, 0.17460273, -0.19030036, 0.073638365, 0.30739737, -0.49666387, 0.35210848, -0.6986693, 0.16907361, 0.18144727, 0.14757599, 0.46443677, 0.18699989, 0.2450093, 0.06936275, 0.02579392, 0.48077604, 0.1351483, 0.047780257, 0.28742442, -0.13160285, -0.058897063, 0.65751755, -0.079751186, -0.084281184, -0.0027703117, 0.22122669, 0.23018235, 0.44145843, 0.21724741, 0.3347463, 0.2290765, 0.32324275, -0.1436107, -0.5186329, 0.117438585, 0.45287052, 0.3579207, 0.23138198, -0.2780454, 0.16367623, 0.29462072, -0.10171037, -0.34191206, 0.055935007, -0.26301888, 0.20438848, 0.18883699, 0.3054475, 0.30529225, 0.17283964, -0.29299167, 0.22716497, -0.1856637, 0.3056756, -0.16731076, -0.06704381, 0.3160015, -0.33330303, 0.01156475, 0.28322798, -0.2652155, 0.02002634, 0.27142313, -0.10664675, 0.027957316, -0.5184376, 0.028287822, -0.14191142, -0.3329025, 0.3358838, -0.39972717, 0.31625396, 0.06505182, 0.13485205, 0.038085077, 0.2900203, 0.35073018, 0.011793219, 0.08421083, -0.0603086, 0.081584856, 0.07020821, 0.3190283, 0.23339857, 0.14690346, 0.71774197, -0.061606396, -0.058847204, 0.12624758, 0.31077176, 0.38894427, 0.49712822, 0.1756283, 0.007241966, -0.03541493, -0.25157017, -0.15651745, -0.10604538, -0.19458169, 0.032917812, -0.13733572, -0.19539586, -0.22128968, 0.425777, 0.1327323, -0.25554323, -0.32247376, 0.150015, 0.19152433, 0.27566287, -0.1771849, 0.45895883, 0.1617406, -0.3677902, 0.041266352, 0.17744032, -0.2150772, -0.038886577, 0.13393204, 0.0132336905, 0.24243818, 0.31560203, -0.18749203, 0.11773903, -0.15935399, -0.18106711, -0.39715898, -0.02446228, 0.53070647, -0.45170844, -0.23692545, 0.30637646, 0.16595091, 0.32924682, 0.21563312, -0.19367856, -0.21539722, 0.30020037, 0.14113097, 0.7408625, -0.11630808, -0.3313717, 0.084368266, -0.17921263, 0.013692388, 0.13854378, -0.30982316, 0.13195539, 0.17927489, -0.08183948, 0.22987077, -0.16272108, 0.36825946, 0.19448507, -0.008757508, 0.2510974, -0.044659186, -0.35157356, 0.08689689, -0.15375204, 0.11628256, 0.36305153, -0.43875483, -0.082487255, -0.29465106, -0.35122845, -0.73413247, 0.11163176, -0.3476162, 0.32065704, -0.40911683, 0.23908934, -0.052865822, 0.018455062, -0.34594643, 0.6216789, 0.01410197, -0.2547901, 0.34921727, 0.17695056, 0.16640632, 0.19060518, -0.26304394, -0.15954413, -0.33594638, 0.34047803, 0.113537356, 0.20210427, -0.26449588, -0.1173275, -0.17880659, -0.20969939, 0.4208703, -0.6745168, -0.07719387, -0.3002708, 0.12279531, 0.6145344, 0.37953308, -0.036984693, -0.22701266, -0.07349657, 0.17873234, 0.1354712, 0.40536624, -0.35294434, -0.033646043, 0.14046985, -0.124437325, 0.16745469, 0.32701164, -0.31365654, 0.29197246, 0.11341109, 0.5664743, -0.1572548, -0.5253334, 0.32682362, -0.086699665, 0.4261434, -0.040479273, -0.09579039, 0.042528428, 0.35417882, -0.22625071, 0.17856611, 0.1362043, 0.07233174, 0.29320574, -0.03136398, -0.7157847, 0.3135886, -0.18831602, 0.092296995, -0.25956255, -0.120861545, 0.062048767, 0.2433275, 0.301131, 0.42110378, -0.08323514, -0.18113801, 0.32738468, 0.35214925, 0.03322563, 0.5009622, -0.08336131, 0.12932627, 0.13562556, -0.30684134, 0.38431802, 0.049728896, -0.26919, 0.4586435, 0.19354923, -0.031431194, -0.020470986, -0.34058574, 0.5284914, -0.15724772, 0.04306467, -0.010698989, -0.32972902, 0.22559293, -0.17746148, 0.30671307, -0.1692213, 0.36443573, 0.21622969, 0.15878741, -0.0026841904, 0.41693047, 0.06036511, 0.095643856, -0.13252325, -0.14308198, -0.38634723, 0.23170374, -0.21380769, 0.15537009, -0.06605951, 0.0019605437, 0.50697505, 0.20135991, -0.20298126, 0.23022987, -0.025947962, -0.35796335, -0.5171197, -0.19837528, 0.15886451, 0.4423183, 0.07221878, -0.14681734, -0.5420088, 0.5317099, 0.36765707, 0.1130036, 0.13330564, -0.1645519, 0.17105404, 0.26162696, -0.020872442, 0.3996716, 0.24685161, 0.16952312, 0.1641811, 0.0068559595, -0.1600587, 0.23859866, -0.18764883, -0.16883981, 0.0014001853, -0.355885, 0.17318471, 0.24934253, -0.29366055, 0.33826762, -0.3334119, 0.16427058, -0.13462773, -0.11438903, 0.091676176, 0.13189416, 0.14411527, 0.11993596, -0.34037963, -0.15300563, 0.1339567, 0.2864874, 0.21824317, -0.3168972, 0.09572235, 0.04772051, -0.27209958, 0.49532926, 0.10919189, 0.20670144, 0.4292437, -0.041907206, 0.013737671, 0.7633014, 0.2136548, -0.29200047, -0.080706455, -0.025309887, 0.27921528, 0.015306009, 0.036515, 0.052477065, -0.13962099, -0.31065398, 0.09047289, -0.39784935, -0.01017768, -0.04884698, 0.11720129, 0.009767994, -0.5075456, 0.050906308, 0.17225741, -0.23176521, 0.2000144, 0.011472835, 0.2511889, -0.32974002, -0.07493364, 0.02702405, 0.37243372, -0.1642386, 0.25370848, 0.08415745, -0.04501254, 0.25614375, -0.10763051, -0.23854291, 0.043273345, -0.2107278, 0.43338677, 0.58206874, 0.131607, -0.021526763, -0.13798904, -0.2642662, 0.15312754, -0.33099124, 0.16042124, 0.40919507, 0.06345656, 0.25629815, 0.22448003, -0.07931542, 0.16061729, -0.22784738, 0.18924448, 0.35777244, -0.017217472, 0.08774099, -0.16351484, -0.0571642, 0.014815131, 0.12454095, -0.082433, 0.0892642, 0.2398573, -0.20514993, 0.45349088, 0.14390776, 0.2808594, -0.27707934, -0.008623056, -0.045462098, 0.013676299, -0.027825017, 0.05732246, 0.4792673, -0.5890094, 0.49840584, -0.2436018, 0.10870745, 0.092316456, 0.1739574, 0.45598945, 0.15600276, 0.29537994, -0.121049196, -0.19391637, 0.6290919, -0.3851677, -0.04898175, 0.17153154, -0.23078832, 0.19234422, -0.060266174, -0.38140658, 0.2245431, -0.091112934, 0.22878523, 0.030412158, -0.061635338, 0.033818647, -0.22959964, 0.4918769, 0.26181188, -0.17721574, -0.5083295, -0.33496875, -0.15137245, -0.3788615, 0.4676191, -0.048445296, 0.15868966, -0.33295783, -0.36022645, -0.76169693, 0.11498959, 0.17274822, -0.22365734, -0.37812397, 0.36443228, 0.053714983, 0.16579725, 0.15086229, 0.5181432, 0.04275773, -0.2157581, 0.1324537, 0.28207287, -0.111025274, 0.16780359, -0.2973866, -0.00051273755, 0.32085696, 0.3039906, 0.13002953, 0.23281525, -0.23040184, -0.1612589, 0.18543458, -0.22197826, 0.44599774, -0.6572777, 0.3454746, 0.26176748, 0.14009385, 0.23479716, -0.060795434, -0.027889976, 0.26821205, -0.14765319, -0.31176427, 0.008109555, 0.11765584, 0.0038289754, -0.07299172, 0.38948137, 0.42167592, 0.0142046, -0.31027, 0.068753116, 0.12332906, -0.12808746, 0.019826928, 0.14183697, -0.41134107, -0.23285355, 0.15269747, 0.3066334, 0.008445032, -0.16779438, 0.14424118, -0.23176205, 0.1205011, -0.35570997, 0.10010425, -0.124371685, -0.4950426, 0.40596685, -0.31280926, 0.10972233, -0.04414225, 0.042946517, -0.21747044, 0.28962794, 0.3680502, 0.06481237, 0.2311863, 0.42081785, -0.08839107, 0.10071783, 0.33453366, 0.13521928, 0.1141759, 0.21084589, -0.37542015, -0.028307257, -0.052553974, -0.03154134, 0.30739278, 0.2415074, 0.14010808, -0.06015298, 0.06937518, -0.097197495, 0.21109636, -0.20891792, -0.091425955, 0.06828135, 0.11740079, 0.24642666, 0.15905868, -0.18545751, -0.2690992, -0.19013487, 0.43773013, -0.15654983, 0.31963402, -0.26988733, -0.03624091, -0.1357602, -0.048452243, 0.16981782, 0.35522538, -0.2422528, 0.035165504, -0.15050825, 0.23279704, -0.17865671, -0.077592716, 0.021032857, 0.07828507, -0.0058909864, 0.051855505, -0.08986358, 0.08284391, 0.043560803, -0.0062565487, 0.006593566, -0.26007232, 0.10720693, 0.11382188, -0.416328, -0.13068856, 0.12867261, -0.5147085, 0.19964714, -0.0035123772, -0.109193854, 0.08701896, -0.2372024, -0.025766024, -0.044206, -0.09554216, -0.4060631, -0.071966946, 0.075170375, -0.27221966, 0.51922506, 0.014363718, -0.1693308, -0.09688883, -0.08731843, 0.2896047, 0.48523512, 0.21168554, 0.05566213, -0.115800135, -0.20920524, 0.05385878, -0.16355056, -0.18148233, 0.4647578, -0.20425965, -0.30111927, -0.18004276, 0.08822846, 0.4290089, 0.30462694, 0.40902278, 0.03180632, 0.3192228, 0.19736373, -0.09526598, 0.34012508, 0.088036396, -0.30320635, 0.25557843, 0.0043535093, 0.30250978, 0.26921746, 0.47618955, -0.015054414, 0.24487539, -0.19003831, -0.19424541, 0.27551746, -0.1245058, 0.35422426, 0.18905741, 0.35626438, 0.01964436, 0.24941239, 0.4205592, -0.06368215, 0.12606095, 0.19814397, 0.10796243, 0.27727306, -0.16536811, 0.035831396, -0.051241476, 0.20877734, 0.3608804, -0.016708987, -0.09686814, 0.21246368, -0.085604206, -0.059159398, -0.04620953, -0.29442483, 0.21723959, -0.17902821, 0.47040376, -0.2346897, -0.39638808, 0.24005558, 0.14919518, 0.32014066, -0.16703059, 0.3813941, 0.06467608, 0.23992942, -0.440969, 0.39828312, -0.06413849, -0.17548463, 0.082586095, 0.15245187, -0.78054774, 0.44857553, 0.113132864, -0.06968565, -0.099194065, 0.26506853, -0.07528369, -0.45276558, 0.09761457, 0.47695905, 0.0040502166, -0.31784835, 0.01620779, -0.13657421, -0.2222997, 0.476844, -0.32863343, -0.1528946, -0.18260638, -0.04842771, 0.5791803, 0.32625264, 0.23051542, -0.021585578, 0.317272, -0.23005979, 0.14969656, -0.055579703, 0.14856791, 0.14354895, -0.25304234, -0.18784069, 0.38117245, -0.20474519, -0.06281123, 0.2218327, 0.22093849, 0.122274786, -0.2816066, -0.44446674, 0.10896954, -0.3042202, 0.20238565, 0.013383421, -0.26956615, 0.13895959, 0.059482753, -0.028168518, 0.1522866, -0.25747785, 0.29043669, -0.30523103, 0.44848105, 0.49934503, -0.10706986, -0.12328168, -0.12894435, 0.37250173, 0.07802041, 0.27489564, 0.35056046, -0.12841369, 0.47012335, 0.28368342, -0.8119536, 0.22475582, -0.23598123, -0.31637478, -0.025690565, -0.25247765, 0.28713357, 0.064795494, -0.33838582, 0.11620416, 0.23765394, 0.028397508, -0.19437383, 0.48205706, -0.3657899, 0.2844763, -0.25536597, -0.08705708, -0.016094083, -0.11859547, 0.35750896, -0.019716404, -0.14236599, -0.18648016, -0.118502684, -0.36425555, 0.29833272, -0.13648333, 0.25307798, 0.29955766, -0.26449588, 0.16825895, -0.32715443, 0.011632534, -0.39528346, -0.3258064, -0.22114584, 0.060251955, -0.10200033, 0.46655408, -0.502482, 0.049571194, -0.0299538, -0.41945007, 0.10483397, 0.5957043, 0.24541381, 0.15220107, 0.20629235, -0.16118827, -0.032038186, 0.21136642, 0.27137104, -0.11609516, 0.06809252, 0.29240507, 0.07865523, -0.0012912928, 0.4168142, -0.10597261, -0.27174348, 0.13323931, 0.01301048, 0.45160586, -0.57486635, 0.18212426, -0.14489096, 0.10564523, -0.19786422, -0.30502668, 0.14704382, 0.30446485, 0.020396441, 0.32589316, -0.008111361, 0.13360874, 0.1336674, 0.29916131, -0.39893883, 0.538437, -0.51196945, -0.2802037, 0.38868952, 0.055344883, 0.27322808, 0.06825101, -0.21331903, 0.15069574, -0.39813608, -0.25073358, 0.32646096, -0.2705215, -0.05601048, -0.30772984, -0.16986309, 0.04775715, -0.13054225, 0.45794922, 0.2860079, 0.30101395, 0.2376961, 0.03809656, 0.47447386, -0.025471764, -0.22648928, -0.06465298, -0.11626168, 0.11597422, 0.3258171, -0.14279988, -0.29023582, 0.3573241, 0.16227229, 0.15973108, 0.011769729, 0.038886983, 0.3307752, 0.33542734, 0.20036635, 0.330968, 0.079959914, 0.1175243, 0.09828029, -0.17211105, -0.26685244, 0.30886358, -0.06750361, -0.11142286, -0.2636289, 0.12003111, -0.15292498, -0.33851472, -0.38215706, -0.17178346, -0.32313296, 0.4793384, 0.18573202, 0.16057217, -0.13101357, -0.23883684, 0.09219857, 0.42643264, 0.19503736, 0.086103044, -0.075447455, -0.011464169, -0.12994379, -0.34971327, -0.12262662, -0.33512974, -0.037697174, 0.37231112, 0.2581261, 0.016041651, 0.09535048, -0.08843185, 0.54240537, -0.013675093, -0.1814374, 0.45855308, 0.05575154, 0.11784962, 0.16170475, -0.036446474, -0.06853944, 0.5145053, -0.37320358, -0.3582225, 0.047913082, 0.19636899, -0.18028581, -0.35682178, -0.054477412, 0.47814456, 0.12739414, 0.27044642, 0.1872164, -0.054906253, 0.5406601, 0.1472963, 0.27982372, 0.1275577, -0.22528826, 0.22691208, 0.28482172, 0.0014677572, -0.11731455, 0.013605437, -0.2408797, -0.077624, -0.16257782, -0.29907018, -0.09358819, 0.009879311, 0.17868097, -0.052284274, -0.5126222, 0.43821776, -0.065383814, 0.08397019, -0.27800092, 0.2803854, 0.4558166, 0.30450076, -0.10809724, 0.06116048, 0.032445528, 0.17082423, -0.00022320892, -0.2549617, 0.04035041, 0.19968374, 0.2605248, 0.22139278, -0.162508, 0.19763549, 0.15229212, -0.4230671, 0.13902844, -0.2450281, 0.19368485, 0.12475128, -0.15994315, 0.31416517, -0.43257657, 0.432814, -0.4393672, 0.11753534, -0.4317489, 0.022503663, 0.029287698, 0.3761381, -0.097059146, 0.14691195, 0.03199887, 0.14046359, -0.16240549, 0.5505331, 0.35941416, -0.091636635, 0.025337879, 0.13568603, 0.050688196, 0.13052092, -0.21257766, -0.006634574, 0.07215157, -0.35892144, 0.2810557, -0.4680491, 0.46606717, 0.09393112, -0.06562549, -0.25533456, -0.10601328, 0.40427643, 0.10308578, 0.7812101, -0.44214624, -0.65713966, -0.46392232, 0.46884564, -0.63103926, 0.500399, 0.13751994, -0.143944, -0.37009692, -0.418311, -0.26072714, -0.25271624, 0.31412017, -0.088414684, -0.20979986, 0.6910876, -0.29415572, -0.5284622, -0.24705993, 0.058527507, -0.51359814, 0.5057545, -0.47619727, -0.76855123, 0.4361558, 0.20146753, -0.5880287, 0.2717806, -0.48343408, -0.41231912, 0.48136953, 0.4344149, 0.04177817, 0.6003413, 0.17011435, -0.03336891, 0.19229811, -0.2373328, -0.4181111, -0.76593786, -0.07941568, 0.39602062, 0.33122334, 0.5655735, -1.0608528, 0.12201145, -0.105849676, 0.42430425, 0.24960679, -0.7085994, 0.20589963, -0.41316402, -0.14016415, 0.23571116, 0.016161077, 0.076196514, -0.32360402, 0.22967267, -0.5577196, -0.93322206, -0.3277844, 0.42955613, 0.38445285, 0.38649455, -0.42670378, 0.47998747, -0.3419757, 0.023598654, 0.41223565, 0.52824646, -0.46085006, 0.18646933, 0.25215882, -0.504759, -1.324383, 0.35988835, 0.0035874909, 0.37636146, -0.78838867, 0.6240863, -0.49322745, 0.4517774, 0.0788566, -0.27299148, -0.29275313, 0.27706367, 0.26723093, 0.19325674, -0.33203226, -0.4804978, 0.39699528, -0.17849827, -0.020428026, -0.0044608773, 0.018910663, -0.18745734, -0.33677238, 0.40236408, -0.6176029, -0.4127225, 0.48356685, -0.23069592, 0.23472627, -0.3104406, -0.00035144232, 0.39359617, 0.15752108, 0.34857604, 0.35533962, 0.18166885, -0.35759172, -0.40531448, -0.32014647, -0.559122, -0.9711462, -0.4890566, 0.4533232, 0.49259415, 0.16072269, -0.17925772, -0.41982386, -0.14714025, -0.028735222, -0.2804963, 0.5099306, -0.82522917, 0.48048282, 0.20378713, 0.551647, -0.010655482, -0.049402647, -0.68429667, -0.99154365, -0.5691837, 0.7490115, -0.2474756, 0.1686183, -0.57310504, 0.49446234, -0.73352605, -0.35404253, -0.09004492, 0.3177148, -0.4098433, -1.1752952, 0.62863195, 0.16157566, -0.2996444, -0.40093854, -0.045483142, -0.7100051, 0.5403355, 0.21782742, 0.5704913, -0.7999583, -0.29039434, -0.36272132, -0.01986531};
  double biases[] = {0.25800943, -0.06431384, 0.040365573, 0.048816428, 0.24395046, 0.30785054, 0.062591106, 0.5414444, 0.12631172, -0.09266103, -0.15202793, -0.10926817, 0.129321, 0.5503612, 0.25167632, 0.07022165, -0.09288682, 0.015008575, 0.36776868, -0.25269204, 0.27098054, 0.48369783, -0.09453718, 0.49849448, 0.25089625, 0.18170334, -0.25059405, 0.1806397, 0.07832606, 0.243902, -0.07173503, 0.018116007, 0.27150667, -0.05228848, -0.0002770075, -0.12799151, 0.27997476, 0.21468692, -0.15320365, -0.08244881, 0.0419605, -0.0772076, -0.14269221, -0.14467879, 0.095567495, 0.095888264, 0.15596263, -0.08585383, 0.38504398, -0.037232358, -0.087513745, 0.01875779, -0.031082498, 0.10708257, -0.04797474, 0.084015325, -0.050857116, 0.4000258, 0.096078984, 0.3063404, -0.0043769768, 0.04432221, 0.31054354, -0.032721452, -0.17070709, 0.23440422, -0.073793784, -0.009373456, -0.07058865};
  double inputs[] = {6.474152344, -1.182777832, 3.332847656, -12.81738281, 54.19921875, -3.356933594, 7.377091939, 55.79524727, 11.0};
  double output[5] = {};

  MicroMLP mlp(sizeof(topology)/sizeof(topology[0]), topology, weights, biases, SIGMOID);

  mlp.feedforward(inputs, output);

  Serial.print("Inputs: ");
  for (int i = 0; i < sizeof(inputs) / sizeof(inputs[0]); i++) {
    Serial.print(inputs[i]);
    if (i < sizeof(inputs) / sizeof(inputs[0]) - 1) {
      Serial.print(", ");
    }
  }
  Serial.println();

  Serial.print("Neural Network Output: ");
  for (int i = 0; i < sizeof(output) / sizeof(output[0]); i++) {
    Serial.print(output[i]);
    if (i < sizeof(output) / sizeof(output[0]) - 1) {
      Serial.print(", ");
    }
  }
  Serial.println();

  const char* labels[] = {"grazing", "standing", "trotting-rider", "walking-natural", "walking-rider"};

  int max_index = 0;
  for (int i = 1; i < sizeof(output) / sizeof(output[0]); i++) {
    if (output[i] > output[max_index]) {
      max_index = i;
    }
  }

  Serial.print("Predicted Label: ");
  Serial.println(labels[max_index]);
}

void loop() {
  // Placeholder loop function
}
